name: Metrics
on:
  schedule: [{cron: "0 0 * * *"}]
  workflow_dispatch:
  push: {branches: ["master", "main"]}
jobs:
  github-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - uses: lowlighter/metrics@latest
        with:
          token: ${{ secrets.METRICS_TOKEN }}

          # --- База (Оптимизация высоты) ---
          template: classic
          # Убрали 'community' и 'metadata' чтобы уменьшить высоту
          base: header, activity, repositories
          config_timezone: Europe/Minsk
          config_display: large
          config_padding: 0, 5 
          config_octicon: yes
          
          # --- Плагин: Календарь ---
          plugin_isocalendar: yes
          plugin_isocalendar_duration: half-year

          # --- Плагин: Языки ---
          plugin_languages: yes
          plugin_languages_sections: most-used
          plugin_languages_details: lines, percentage
          # Акцентный цвет только тут
          plugin_languages_colors: "TypeScript:#00ffb9, JavaScript:#00d49a, HTML:#009e76, CSS:#5ec4a8, Rust:#007a5e, MDX:#d4f7ed"
          plugin_languages_limit: 6

          # --- Плагин: Ачивки (FIXED) ---
          plugin_achievements: yes
          plugin_achievements_display: compact
          plugin_achievements_secrets: no # Отключаем, чтобы избежать ошибок доступа
          plugin_achievements_threshold: B # Показываем только значимые ачивки
          plugin_achievements_limit: 4 # Ограничиваем кол-во, чтобы не раздувать высоту

          # --- СТИЛЬ: SWISS GRID / MINIMAL BAUHAUS ---
          extras_css: |
            /* 1. СБРОС СТИЛЕЙ: Полная геометрия */
            * { 
              border-radius: 0 !important; 
              font-family: 'Segoe UI', Arial, sans-serif !important;
            }

            /* 2. ЦВЕТОВАЯ СХЕМА: Темная тема с тонкими линиями */
            /* Фон всей картинки */
            svg { 
              background-color: #0d1117 !important; 
            }
            
            /* 3. ЗАГОЛОВКИ: Минимализм */
            h1, h2, h3 {
              color: #00ffb9 !important; /* Ваш мятный цвет */
              text-transform: uppercase;
              letter-spacing: 2px;
              font-size: 14px !important;
              margin-bottom: 5px !important;
            }

            /* 4. СЕТКА (GRID): Тонкие границы вместо теней */
            section, .field {
              background: transparent !important;
              border: 1px solid #30363d; /* Цвет границ GitHub Dimmed */
              margin-bottom: 8px !important; /* Уменьшаем отступы */
              padding: 8px !important;
              box-shadow: none !important; /* УБРАЛИ ТЕНИ */
            }

            /* 5. КАЛЕНДАРЬ: Плоский вид */
            .isocalendar .day { 
              stroke: #0d1117 !important; /* Границы цвета фона */
              stroke-width: 2px;
            }
            /* Яркие цвета активности */
            .isocalendar .day.l1 { fill: #0e4429 !important; }
            .isocalendar .day.l2 { fill: #006d32 !important; }
            .isocalendar .day.l3 { fill: #26a641 !important; }
            .isocalendar .day.l4 { fill: #00ffb9 !important; }

            /* 6. ПРОГРЕСС-БАРЫ: Тонкие линии */
            .progress-bar {
              height: 6px !important; /* Делаем тоньше */
              background-color: #21262d !important;
              border: none !important;
            }

            /* Убираем лишний текст, чтобы было чище */
            .field .content { font-size: 12px; color: #8b949e; }
            
            /* Цвет иконок */
            .octicon { fill: #e6edf3 !important; }
